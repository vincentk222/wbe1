<!-- auth.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Authentification</title>
    <script src="https://alcdn.msauth.net/browser/2.13.1/js/msal-browser.min.js" integrity="sha384-+vJGnYt4zLXAClD9H+6jLpM9G5SfnwWlWlYvT7l0jX4Hj5QfZIvdia5VnR6bnX8w" crossorigin="anonymous"></script>
</head>
<body>
    <script>
        // Supposons que vous ayez déjà configuré MSAL et que vous avez récupéré le token d'accès.
        fetch("https://graph.microsoft.com/v1.0/me", {
            headers: {
                "Authorization": `Bearer ${tokenResponse.accessToken}`
            }
        })
        .then(resp => resp.json())
        .then(data => {
            localStorage.setItem('isAuthenticated', 'true');
            localStorage.setItem('userName', data.displayName);
            localStorage.setItem('userEmail', data.mail || data.userPrincipalName); // Utilisez userPrincipalName si mail est vide
            // Stocker également l'heure actuelle comme heure de connexion
            localStorage.setItem('loginTime', new Date().toString());
            
            window.location.href = 'test.html'; // Redirigez vers test.html
        })
        .catch(error => {
            console.error("Erreur lors de la récupération des informations de l'utilisateur : ", error);
        });
    </script>
    
    
</body>
</html>
